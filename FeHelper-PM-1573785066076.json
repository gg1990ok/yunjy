/* Page modifier config, exported from FeHelper, timestamp:1573785066076 */

[
    {
        "mName": "听课",
        "mPattern": "/^http:\\/\\/px\\.yx\\.yunjy\\.com\\.cn.+learn/",
        "mFilter": "0",
        "mScript": "/**\n *  听课页面js\n * 匹配规则：/^http:\\/\\/px\\.yx\\.yunjy\\.com\\.cn.+learn/\n */\n\n\n // 重置alert方法，防止alert中断页面执行\nwindow.alert = function (str) {\n  layer.alert(str);\n  console.log(str);\n  // lastone 标识当前页面 是否是 当前章节最后一个 未听完的课程\n  // 1 是最后一个，将关闭页面。\n  if (localStorage.getItem(\"lastone\") == '1') {\n    localStorage.setItem(\"lastone\", \"0\");\n    window.open('', '_self'); window.close();\n  } else if (str == \"更新学习时间成功！\") {\n    // 更新成功 关闭窗口\n    window.open('', '_self'); window.close();\n  }\n}\n\n// 引入验证码识别库\nvar script = document.createElement(\"script\");\nscript.type = \"text/javascript\";\nscript.src = \"https://cdn.jsdelivr.net/gh/naptha/tesseract.js@v1.0.14/dist/tesseract.min.js\";\ndocument.getElementsByTagName('head')[0].appendChild(script);\n\n// 引入layer\nvar script2 = document.createElement(\"script\");\nscript2.type = \"text/javascript\";\nscript2.src = \"https://cdn.bootcss.com/layer/2.3/layer.js\";\ndocument.getElementsByTagName('head')[0].appendChild(script2);\n\n// 引入layer样式\nvar link = document.createElement(\"link\");\nlink.rel = \"stylesheet\";\nlink.href = \"https://cdn.bootcss.com/layer/2.3/skin/layer.css\";\ndocument.getElementsByTagName('head')[0].appendChild(link);\n\n//  看门狗标识，识别验证码只执行一次\nvar guo_flag = true;\n\n// 识别验证码方法\nfunction scanCode(callback) {\n  callback = callback || function () { };\n  // ====识别验证码开始====\n  window.img_src = \"http://px.yx.yunjy.com.cn/px/PX201908290001/validateCode?\" + Math.random();\n  console.log(img_src);\n  Tesseract.recognize(img_src, {\n    classify_bln_numeric_mode: 1\n  }).then(function (result) {\n    $(\"#inputvalcode1\").val(result.text);\n    // 提交\n    callback();\n  });\n}\n\n// 覆盖页面的 同名方法\nfunction ChangeTime() {\n  //  设置为最大时间20分钟\n  TimeNum = 1200;\n  if (TimeNum > 0) {\n    timeStr = setTimeout(\"ChangeTime()\", 1000);\n    if (TimeNum > 5 && 7 > TimeNum) {//大于5s，隐藏计时框\n      btnOclick();\n    }\n\n    if (TimeNum >= 0) {//大于10分钟测试\n      //console.log($(\"#titleType\").is(\":visible\"))\n      //console.log($(\"#validateType\").is(\":visible\"))\n      if ($(\"#titleType\").is(\":visible\")) {\n        abledRadio();//设置单选框为可选状态 在courseTitle.ftl页面\n      }\n      if ($(\"#validateType\").is(\":visible\")) {\n        $(\"#comfirmButtonTo\").show();\n        ischeck = true;\n      }\n      if (timing_needs_code == 2) {\n        $(\"#comfirmButtonTo\").show();\n      }\n    }\n  }\n  document.getElementById(\"learnTime\").value = +Math.floor(TimeNum / 60) + \"分\" + TimeNum % 60 + \"秒\";\n\n  // 只会执行一次\n  if (guo_flag && !$(\"#inputvalcode1\").is(':hidden')) {\n    guo_flag = false;\n\n    // ====识别验证码开始====\n    scanCode(function () {\n      // 识别后 提交\n      $(\"#comfirmButtonTo\").click();\n    })\n\n    // ====识别验证码结束====\n\n  }\n}\n\n$(function () {\n  // 在学习区会先保存 用户id\n  var userId = localStorage.getItem(\"userId\");\n  // locaStroage 中存放 已经学完的id，下次不再打开。\n  var exit = \"exit\" + userId;\n  if ($(\"#learnTime\").length == 0) {\n    // 记录已经看完的 课程id\n    var array = JSON.parse(localStorage.getItem(exit));\n    var id = location.href.match(/\\/[0-9]\\/([0-9]{5})/)[1];\n    if (array.indexOf(id) == -1) {\n      array.push(id);\n      localStorage.setItem(exit, JSON.stringify(array));\n    }\n\n    // 如果是最后一个页面将关闭\n    if (localStorage.getItem(\"lastone\") == '1') {\n      localStorage.setItem(\"lastone\", \"0\");\n      window.open('', '_self'); window.close();\n    }\n  }\n})\n",
        "mRefresh": "0",
        "mDisabled": false,
        "id": "mf_1570506009031"
    },
    {
        "mName": "学习区",
        "mPattern": "/^http:\\/\\/px\\.yx\\.yunjy\\.com\\.cn.+student\\/4227$/",
        "mFilter": "0",
        "mScript": "/**\n * 学习区页面 脚本\n * \n * 主要用于循环打开 各个课程\n * 页面匹配规则： /^http:\\/\\/px\\.yx\\.yunjy\\.com\\.cn.+student\\/4227$/\n */\n$(function () {\n  var userId = $(\".top-dl\").text().match(/^[0-9]{10}([0-9]{7})/)[1];\n  localStorage.setItem(\"userId\", userId);\n\n  // sIndex 中存放章节 id，一章一章循环刷。\n  var aIndex = \"aIndex\" + userId;\n  var exit = \"exit\" + userId;\n\n  if (!localStorage.getItem(aIndex)) {\n    localStorage.setItem(aIndex, 0);\n  }\n\n  if (!localStorage.getItem(exit)) {\n    localStorage.setItem(exit, \"[]\");\n  }\n  var index = localStorage.getItem(aIndex);\n  var aaaLen = $(\".start-center-list\").children().length;\n  var element = $(\".start-center-list\").children().get(index);\n  var $go = $(element).find(\".go\");\n  var goLen = $go.length\n\n  var arrayExit = JSON.parse(localStorage.getItem(exit));\n\n  var listArray = [];\n  for (var j = 0; j < goLen; j++) {\n    var href = $go[j].href;\n    var id = href.match(/\\/([0-9]{5})\\//)[1];\n    if (/^http+/.test(href) && arrayExit.indexOf(id) == -1) {\n      listArray.push(href);\n    }\n  }\n\n  localStorage.setItem(\"lastone\", \"0\");\n  if (listArray.length > 0) {\n    var win = window.open(listArray[0], \"_blank\", \"channelmode=yes\");\n    if (listArray.length > 1) {\n\n      for (var i = 1; i < listArray.length; i++) {\n        setTimeout((function (i) {\n          return function () {\n            if (i == listArray.length - 1) {\n              localStorage.setItem(\"lastone\", \"1\");\n            } else {\n              localStorage.setItem(\"lastone\", \"0\");\n            }\n            win.open(listArray[i], \"_self\");\n\n          }\n        })(i), i * 20 * 1000);\n      }\n\n    } else {\n      localStorage.setItem(\"lastone\", \"1\");\n    }\n\n  } else {\n    var indexnew = localStorage.getItem(aIndex);\n    var indexplus = Number(indexnew) + 1;\n    if (indexplus < aaaLen - 1) {\n      localStorage.setItem(aIndex, indexplus);\n      location.reload();\n    }\n  }\n})",
        "mRefresh": "600",
        "mDisabled": false,
        "id": "mf_1573733898306"
    },
    {
        "mName": "选课页面过滤",
        "mPattern": "/^http:\\/\\/px\\.yx\\.yunjy\\.com\\.cn.+studentChooseCourse.+/",
        "mFilter": "0",
        "mScript": "$(function(){\n  var userId = localStorage.getItem(\"userId\");;\n  var exit = \"exit\"+userId;\n    var array = JSON.parse(localStorage.getItem(exit));\n    var id = location.href.match(/e\\/([0-9]{5})/)[1];\n    if(array.indexOf(id) == -1) {\n      array.push(id);\n    \tlocalStorage.setItem(exit, JSON.stringify(array));\n    }\n    \n    if(localStorage.getItem(\"lastone\") == '1') {\n      localStorage.setItem(\"lastone\", \"0\");\n  \t\twindow.open('', '_self');window.close();\n  \t}\n})\n  ",
        "mRefresh": 0,
        "mDisabled": false,
        "id": "mf_1573782717644"
    }
]